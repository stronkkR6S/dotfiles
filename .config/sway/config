include colors.conf

#############################
#        Variables          #
#############################
set $mod Mod4
set $left h
set $down j
set $up k
set $right l
set $term foot
set $menu wofi --show drun --normal-window
set $browser firefox-bin

#############################
#       Monitor Setup       #
#############################
output eDP-1 resolution 1920x1080@60Hz position 0 0 scale 1
# Run: swaymsg -t get_outputs to list outputs

#############################
#        Autostart          #
#############################

# Start PipeWire stack using Gentoo's launcher script
exec gentoo-pipewire-launcher & disown
# Export environment variables to elogind's user session (so D-Bus apps get them)
exec hash dbus-update-activation-environment 2>/dev/null && \
dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK XDG_CURRENT_DESKTOP=sway

## Prevent GTK apps (like Thunar, Gedit) from hanging on launch
exec dbus-update-activation-environment --systemd DBUS_SESSION_BUS_ADDRESS DISPLAY XAUTHORITY
#also install xhost and xhost +SI:localuser:root for timeshift
# Start xdg-desktop-portal services (ensure wlr starts first)
exec --no-startup-id /usr/libexec/xdg-desktop-portal-wlr
exec --no-startup-id /usr/libexec/xdg-desktop-portal -r

# Clipboard / Notification daemons
exec wl-paste --type text  --watch cliphist store
exec wl-paste --type image --watch cliphist store
exec wl-clip-persist --clipboard regular

exec_always {
    xrdb ~/.Xdefaults
}

######## Auto Tiling
exec autotiling -l 2
# Brightness preset
exec brightnessctl set 35%

# Personal helper scripts
#exec /home/ravish/script/music.sh
exec /home/ravish/script/battery.sh
exec /home/ravish/script/brightness.sh
exec /home/ravish/script/volume.sh
#exec /home/ravish/script/time.sh


# Restart every reload
exec waybar
exec_always swww-daemon
exec swaync
exec hypridle
exec /usr/libexec/hyprpolkitagent

#############################
#       Input Config        #
#############################
seat seat0 xcursor_theme Bibata-Modern-Ice 24

input "E-Signal USB Gaming Mouse Keyboard" {
    accel_profile "flat"       # raw-like movement
    pointer_accel 0            # no scaling (1:1)
}

input type:touchpad {
    tap enabled
    dwt enabled
    natural_scroll enabled
    middle_emulation enabled
    scroll_factor 0.2
    pointer_accel 0.2
    accel_profile flat
    #accel_profile adaptive for acceleration
    scroll_method two_finger
}

input "1:1:AT_Translated_Set_2_keyboard" {
    xkb_options "caps:escape"
    repeat_delay 250 
    repeat_rate 30
}

#############################
#       Keybindings         #
#############################
# Launchers
bindsym $mod+Return exec $term
bindsym alt+Return exec alacritty
bindsym $mod+space exec $menu
bindsym alt+space exec rofi -show drun
bindsym $mod+b exec $browser
bindsym $mod+c kill
bindsym $mod+f exec thunar
bindsym $mod+e exec wlogout -b 6
bindsym $mod+n exec swaync-client -t
bindsym alt+b exec zen
bindsym $mod+l exec hyprlock

# Scripts
bindsym $mod+r exec /home/ravish/script/waybar.sh
bindsym alt+w exec /home/ravish/script/wallSelect.sh
bindsym Print exec /home/ravish/script/screenshot.sh
bindsym $mod+Print exec /home/ravish/script/screenshot_region.sh
bindsym $mod+shift+e exec rofi -modi emoji -show emoji
bindsym $mod+shift+v exec cliphist list | wofi -dmenu | cliphist decode | wl-copy
#bindsym $mod+shift+r exec /home/ravish/script/record.sh
bindsym alt+0 exec /home/ravish/script/share.sh
bindsym alt+g exec /home/ravish/script/a.sh


# Reload
bindsym $mod+ctrl+r reload

# Floating modifier
floating_modifier $mod normal

# Window movement (Vim + arrows)
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right
bindsym alt+$left move left
bindsym alt+$down move down
bindsym alt+$up move up
bindsym alt+$right move right
bindsym alt+Left move left
bindsym alt+Down move down
bindsym alt+Up move up
bindsym alt+Right move right
bindsym $mod+control+Right workspace next
bindsym $mod+control+Left workspace prev

# Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10
bindsym $mod+Shift+1 exec swaymsg move container to workspace number 1 \; workspace number 1
bindsym $mod+Shift+2 exec swaymsg move container to workspace number 2 \; workspace number 2
bindsym $mod+Shift+3 exec swaymsg move container to workspace number 3 \; workspace number 3
bindsym $mod+Shift+4 exec swaymsg move container to workspace number 4 \; workspace number 4
bindsym $mod+Shift+5 exec swaymsg move container to workspace number 5 \; workspace number 5
bindsym $mod+Shift+6 exec swaymsg move container to workspace number 6 \; workspace number 6
bindsym $mod+Shift+7 exec swaymsg move container to workspace number 7 \; workspace number 7
bindsym $mod+Shift+8 exec swaymsg move container to workspace number 8 \; workspace number 8
bindsym $mod+Shift+9 exec swaymsg move container to workspace number 9 \; workspace number 9
bindsym $mod+Shift+0 exec swaymsg move container to workspace number 10 \; workspace number 10

# Layout control
bindsym $mod+ctrl+b splith
bindsym $mod+ctrl+v splitv
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+z fullscreen
bindsym $mod+t floating toggle
bindsym $mod+shift+t focus mode_toggle
bindsym $mod+a focus parent

# Scratchpad
scratchpad_minimize disable
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show

# Resize windows
bindsym $mod+Shift+Right resize grow width 30px
bindsym $mod+Shift+Left  resize shrink width 30 px
bindsym $mod+Shift+Up    resize shrink height 25 px
bindsym $mod+Shift+Down  resize grow height 25 px

# System keys
bindsym --locked XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym --locked XF86MonBrightnessUp exec brightnessctl set 5%+
bindsym XF86AudioMute exec wpctl set-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioRaiseVolume exec wpctl set-volume -l 1 @DEFAULT_SINK@ 5%+
bindsym XF86AudioLowerVolume exec wpctl set-volume @DEFAULT_SINK@ 5%-
bindsym XF86AudioMicMute exec wpctl set-mute @DEFAULT_SOURCE@ toggle
bindsym XF86Launch1 exec /home/ravish/script/power.sh
bindsym F4 exec /home/ravish/script/keyboard.sh

#############################
#   Window Specific Rules   #
#############################
# Floating roles/types
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="dialog"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable

# Floating apps
for_window [app_id="floating"] floating enable
for_window [app_id="floating_update"] floating enable, resize set width 1000px height 600px
for_window [class="(?i)pinentry"] floating enable
for_window [title="Administrator privileges required"] floating enable

# Firefox tweaks
for_window [title="About Mozilla Firefox"] floating enable, move position center
for_window [app_id="firefox" title="Library"] floating enable, move position center, border pixel 1, sticky enable
for_window [title="Firefox â€” Sharing Indicator"] kill
for_window [title="Firefox - Sharing Indicator"] kill

# App window size
for_window [app_id="nwg-look"] floating enable, resize set width 80 ppt height 80 ppt
for_window [app_id="wofi"] border pixel 2
for_window [app_id="org.telegram.desktop"] floating enable, resize set width 95 ppt height 95 ppt
for_window [class="vesktop"] floating enable, resize set width 95 ppt height 95 ppt


#############################
#       Appearance          #
#############################
xwayland enable
default_border pixel 2
default_floating_border pixel 2
gaps inner 7
gaps outer 5
corner_radius 4

# Blur and shadows
blur enable
blur_xray off
blur_passes 4
blur_radius 4
shadows enable
shadows_on_csd enable
shadow_blur_radius 10
shadow_offset 5 5
shadow_color #0000007F
shadow_inactive_color #0000003F

# Layer effects
layer_effects "waybar" {
    blur enable;
    blur_xray enable;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "swaync-control-center" {
    blur enable;
    blur_xray disable;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "swaync-notification-window" {
    blur enable;
    blur_xray disable;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "logout_dialog" {
    blur enable;
    blur_xray disable;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "wofi" {
    blur enable;
    blur_xray disable;
    corner_radius 13;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "rofi" {
    blur enable;
    blur_xray disable;
    blur_ignore_transparent enable;
    shadows disable;
}
layer_effects "gtk-layer-shell" blur enable; shadows enable; corner_radius 20

# Window dimming + opacity
default_dim_inactive 0.15
for_window [app_id=".*"] opacity 0.85
for_window [class=".*"] opacity 0.85
for_window [app_id="mpv"] opacity 1 
for_window [app_id="mpv"] blur disabled
for_window [class="vlc"] opacity 1
for_window [class="vlc"] blur disabled
for_window [class="steam"] opacity 1 
for_window [class="steam"] blur disable
for_window [class="qemu-system-x86_64"] opacity 1 
for_window [class="qemu-system-x86_64"] blur disable
for_window [app_id="org.pwmt.zathura"] opacity 1

#############################
#         Includes          #
#############################

include /etc/sway/config.d/*
